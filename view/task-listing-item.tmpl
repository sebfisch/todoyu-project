<div id="task-{$task.id}" class="task status{ucfirst $task.statuskey} {$task.class}">
	<h3 id="task-{$task.id}-header" class="contextmenutask" name="task-{$task.id}" onclick="Todoyu.Ext.project.Task.toggleDetails({$task.id})">

		<span class="headLabel bcStatus{$task.status}" title="{htmlencode $task.fulltitle}">
			<span class="taskDate date" title="{Label core.global.deadline}: {dateFormat $task.date_end D2M2Y2} / {Label core.global.start}: {dateFormat $task.date_start D2M2Y2}">
				{if $task.date_end > 0}
					{dateFormat $task.date_end D2M2Y2}
				{else}
					{dateFormat $task.date_deadline D2M2Y2}
				{/if}
				&nbsp;
			</span>
			<span class="customer">
				{if $task.company.shortname}{htmlencode $task.company.shortname}{else}{htmlencode $task.company.title}{/if}&nbsp;
			</span>
			<span class="projectName" title="{Label project.ext.project}: {htmlencode $task.project.title} (ID: {$task.project.id}) / {Label project.task.task}: {htmlencode $task.title}">
				{htmlencode(truncate($task.project.title,45))} - {htmlencode(truncate($task.title,45))}
			</span>
		</span>

		<span class="taskNumber" title="{Label portal.ext.tasktree.header.tasknumber}: {$task.id_project}.{$task.tasknumber}">
			{$task.id_project}.{$task.tasknumber}
		</span>
		<span class="taskIcons{if sizeof($taskIcons) > 4} taskIconsOverflow{/if}">
			{foreach $taskIcons taskIcon}
				<span id="{$taskIcon.id}" class="{$taskIcon.class}" title="{Label $taskIcon.label true}" {if $taskIcon.onclick}onclick="{$taskIcon.onclick}"{/if}></span>
			{/foreach}
		</span>
	</h3>
	{$details}
</div>