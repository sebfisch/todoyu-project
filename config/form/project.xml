<?xml version="1.0" encoding="UTF-8"?>
<form>
	<attributes>
		<attribute name="action">?ext=project&amp;controller=project</attribute>
		<attribute name="name">project</attribute>
	</attributes>
	<hiddenFields>
		<field name="id" />
	</hiddenFields>
	<fieldsets>

		<fieldset name="main">
			<legend>Top</legend>
			<class>top</class>
			<elements>

				<fieldset name="basic">
					<legend>Main project data</legend>
					<class>basic</class>
					<elements>

						<field type="textinput" name="title">
							<label>core.title</label>
							<validate>
								<isNotEmpty msg="LLL:project.form.validation.title"/>
							</validate>
							<required/>
						</field>

						<field type="RTE" name="description">
							<label>core.description</label>
							<tinymce>
								<theme>simple</theme>
								<width>330px</width>
								<height>200px</height>
							</tinymce>
							<required/>
						</field>

					</elements>
				</fieldset>

				<fieldset name="data">
					<legend>Project data</legend>
					<class>data</class>
					<elements>

						<field type="select" name="status">
							<label>core.status</label>
							<source type="function">
								<function>TodoyuProjectViewHelper::getProjectStatusOptions</function>
							</source>
							<noPleaseSelect />
						</field>

						<field type="dateinput" name="date_start">
							<label>project.attr.date_start</label>
							<validate>
								<dateBefore>
									<field>date_end</field>
								</dateBefore>
								<isNotEmpty/>
							</validate>
							<class>myClass</class>
							<required />
						</field>

						<field type="dateinput" name="date_end">
							<label>project.attr.date_end</label>
							<validate>
								<dateAfter>
									<field>date_start</field>
								</dateAfter>
								<isNotEmpty/>
							</validate>
							<required />
						</field>

						<field type="dateinput" name="date_deadline">
							<label>project.attr.date_deadline</label>
							<validate>
								<dateAfter>
									<field>date_start</field>
									<allowEmpty />
								</dateAfter>
							</validate>
						</field>

						<field type="textinputAC" name="id_company">
							<restrict>
								<allow ext="contact" right="general:use" />
							</restrict>
							<label>project.attr.company</label>
							<config>
								<acListener>
									<ext>project</ext>
									<controller>project</controller>
									<action>autocompleteCompany</action>
								</acListener>
								<acLabelFunc>TodoyuCompanyManager::getLabel</acLabelFunc>
								<options>
									<onCompleteCustom>Todoyu.Ext.project.Project.Edit.onCompanyAutocomplete</onCompleteCustom>
								</options>
							</config>
							<required />
						</field>

					</elements>
				</fieldset>

			</elements>
		</fieldset>


		<fieldset name="persons">
			<restrict>
				<allow ext="contact" right="general:use" />
			</restrict>
			<legend>Project Persons</legend>
			<class>persons</class>
			<elements>
				<field type="databaseRelation" name="persons">
					<label>project.attr.persons</label>
					<addLabel>project.attr.persons.new</addLabel>
					<record>
						<form>ext/project/config/form/project-person.xml</form>
						<url>
							<ext>project</ext>
							<controller>project</controller>
						</url>
						<label type="function">
							<function>TodoyuProjectViewHelper::getProjectPersonLabel</function>
							<noLabel>LLL:project.attr.persons.new</noLabel>
						</label>
					</record>
				</field>

			</elements>
		</fieldset>

		<fieldset name="buttons">
			<legend>Actions</legend>
			<class>buttons</class>
			<elements>

				<field type="cancelButton" name="cancel">
					<onclick>Todoyu.Ext.project.Project.Edit.cancel(#id#)</onclick>
				</field>

				<field type="saveButton" name="save">
					<onclick>Todoyu.Ext.project.Project.Edit.save(this.form)</onclick>
				</field>

			</elements>
		</fieldset>

	</fieldsets>
</form>